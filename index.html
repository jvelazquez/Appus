<!DOCTYPE html> 
<html>
<head>
<meta charset="utf-8">
<title>Aplic. Web de jQuery Mobile</title>
<link href="jquery-mobile/jquery.mobile-1.0.min.css" rel="stylesheet" type="text/css"/>
 <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
<script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
<script src="http://code.jquery.com/mobile/1.0/jquery.mobile-1.0.min.js"></script>
	<script src="js/sh.js"></script>
</head> 
<body> 

 
<div data-role="page" id="inicio">
 
<div data-role="header">
<h1>Autenticacion de Usuario</h1>
</div>
<div data-role="content">	

							<form action="" id="login">
							  	<input type="text" id="usuario" name="usuario" placeholder="Ingresa tu usuario" required/>
							  	<input type="password" id="password" name="password" placeholder="Ingresa tu contrasena" required/>
							  	<input type="text"  id="md5" name="md5" value="" />
								<input type="button" id="btn_enviar" value="Iniciar Sesion">
						  </form>
</div>
</div>
<div data-role="page" id="home">
 
<div data-role="header">
<h1>Bienvenido</h1>
</div>
 
<div data-role="content">	
<h2> Bienvenido a la aplicacion </h2>
<h3> Su usuario y password son v√°lidos</h3>
</div>
 
</div>
 
		
<script>
$(document).ready( function(){

$("#btn_enviar").click(function(){

enviaMD5() 			

//var  formData = $("#login").serialize(); //Name value Pair
  var alumno = $("#usuario").val()
  var contrasena = $("#password").val()
  var md5 = $("#md5").val()
  
  archivoValidacion = "http://187.188.173.10/USmobile/Servidor/validacion.php?jsoncallback=?"
  
  $.getJSON( archivoValidacion, {usuario:alumno,password:contrasena,md5:md5})
	.done(function(respuestaServer) {

				if(respuestaServer.mensaje == "ok"){
					
					alert("conecto bien");

					$.mobile.changePage("principal.html")
	   		//window.localStorage["iduser"] = respuesta.idalumno;
				

			//$(location).href('http://187.188.173.10/appus/inicio.html')
				}
	   			else{
		 			
					alert("Error de login");
   				}
          //$("#mensaje").html(respuesta.mensaje);
			});
        	

});


function enviaMD5(hash) 
			{	
				var pass = document.forms["login"].elements["password"].value;
				//alert(pass);
				document.forms["login"].elements["md5"].value = hex_sha1(pass);
                var convertido=hex_sha1(pass);
                //alert(convertido);
				//document.forms["login"].elements["pass"].value = "";
				document.forms["login"].elements["md5"].value = convertido;
			}
			
})
</script>

 
</body>
</html>